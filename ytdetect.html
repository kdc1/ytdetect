<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YouTube URL/ID ì…ë ¥ í¼ + ì°¨ë‹¨ ê°ì§€ ì˜ˆì œ</title>
  <style>
    body {
      font-family: "Noto Sans KR", sans-serif;
      background-color: #fafafa;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }

    h1 {
      margin-bottom: 1rem;
      color: #444;
    }

    form {
      display: flex;
      margin-bottom: 1rem;
    }

    input[type="text"] {
      width: 320px;
      padding: 0.5rem;
      border: 1px solid #bbb;
      border-radius: 4px 0 0 4px;
      outline: none;
      font-size: 1rem;
    }

    input[type="text"]:focus {
      border-color: #0073e6;
    }

    button {
      padding: 0.5rem 1rem;
      background-color: #0073e6;
      color: white;
      font-size: 1rem;
      border: none;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
    }

    button:hover {
      background-color: #005bb5;
    }

    #player {
      width: 560px;
      height: 315px;
      background-color: #000;
      border: 1px solid #ccc;
      margin-top: 1rem;
    }

    #statusMessage {
      margin-top: 1rem;
      color: #d32f2f;
      font-weight: bold;
      min-height: 1.2em;
    }
  </style>
</head>
<body>
  <h1>ì˜ìƒ URL ë˜ëŠ” ì˜ìƒ ID ì…ë ¥ í›„ ì¬ìƒí•˜ê¸°</h1>

  <!-- 1. ì…ë ¥í¼: URL ë˜ëŠ” ID ì…ë ¥ -->
  <form id="videoForm">
    <input
      type="text"
      id="videoInput"
      placeholder="ìœ íŠœë¸Œ ì˜ìƒ URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•˜ì„¸ìš”"
      autocomplete="off"
      required
    />
    <button type="submit">ì¬ìƒ</button>
  </form>

  <!-- 2. YouTube Playerê°€ ë¡œë“œë  ì˜ì—­ -->
  <div id="player"></div>

  <!-- 3. ì—ëŸ¬/ìƒíƒœ ë©”ì‹œì§€ -->
  <div id="statusMessage"></div>

  <!-- 4. YouTube IFrame API ë¡œë“œ -->
  <script>
    // ------------------------------------------------------------
    // 4-1. API ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¹„ë™ê¸°ë¡œ ë¶ˆëŸ¬ì˜¤ê¸°
    // ------------------------------------------------------------
    var tag = document.createElement("script");
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScript = document.getElementsByTagName("script")[0];
    firstScript.parentNode.insertBefore(tag, firstScript);

    // ------------------------------------------------------------
    // ì „ì—­ ë³€ìˆ˜ ì„ ì–¸
    // ------------------------------------------------------------
    var player = null;      // YT.Player ì¸ìŠ¤í„´ìŠ¤
    var apiReady = false;   // IFrame APIê°€ ë¡œë“œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€

    // ------------------------------------------------------------
    // 4-2. API ì¤€ë¹„ ì™„ë£Œ ì½œë°± (YouTubeê°€ ìë™ìœ¼ë¡œ í˜¸ì¶œ)
    // ------------------------------------------------------------
    function onYouTubeIframeAPIReady() {
      apiReady = true;
      console.log("YouTube IFrame API ë¡œë“œ ì™„ë£Œ");
      // ì•„ì§ ì˜ìƒ IDê°€ ì—†ìœ¼ë¯€ë¡œ í”Œë ˆì´ì–´ë¥¼ ìƒì„±í•˜ì§€ ì•ŠìŒ.
      // ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ createOrLoadPlayer()ë¥¼ í˜¸ì¶œ.
    }

    // ------------------------------------------------------------
    // 5. í¼ ì œì¶œ ì´ë²¤íŠ¸ ì²˜ë¦¬
    // ------------------------------------------------------------
    document.getElementById("videoForm").addEventListener("submit", function (e) {
      e.preventDefault();
      var rawValue = document.getElementById("videoInput").value.trim();
      if (!rawValue) return;

      var videoId = extractVideoID(rawValue);
      if (!videoId) {
        displayMessage("âš ï¸ ì˜¬ë°”ë¥¸ ìœ íŠœë¸Œ URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      createOrLoadPlayer(videoId);
    });

    // ------------------------------------------------------------
    // 6. URL ë˜ëŠ” IDì—ì„œ ì‹¤ì œ Video IDë§Œ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
    // ------------------------------------------------------------
    function extractVideoID(urlOrId) {
      // 11ì ID í˜•ì‹ì„ ê¸°ë³¸ìœ¼ë¡œ í•˜ë˜, URL íŒ¨í„´ì´ ë“¤ì–´ì˜¤ë©´ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ IDë¥¼ êº¼ëƒ„
      var id = urlOrId;
      var regExp = /^.*(?:youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#&?]{11}).*/;
      var match = id.match(regExp);
      if (match && match[1]) {
        return match[1];
      }
      // ë§Œì•½ ê¸¸ì´ê°€ 11ìì¸ IDë¼ê³  ê°€ì •í•  ìˆ˜ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜
      if (/^[A-Za-z0-9_-]{11}$/.test(id)) {
        return id;
      }
      return null;
    }

    // ------------------------------------------------------------
    // 7. í”Œë ˆì´ì–´ ìƒì„± ë˜ëŠ” ì´ë¯¸ ìˆìœ¼ë©´ ë¡œë“œë§Œ í•˜ëŠ” í•¨ìˆ˜
    // ------------------------------------------------------------
    function createOrLoadPlayer(videoId) {
      // ë©”ì‹œì§€ ì´ˆê¸°í™”
      clearMessage();

      if (!apiReady) {
        displayMessage("ğŸ”„ YouTube API ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...");
        return;
      }

      if (player === null) {
        // ìµœì´ˆë¡œ í”Œë ˆì´ì–´ ìƒì„±
        player = new YT.Player("player", {
          videoId: videoId, // ì…ë ¥ë°›ì€ ì˜ìƒ ID
          playerVars: {
            rel: 0,
            modestbranding: 1,
          },
          events: {
            onReady: onPlayerReady,
            onError: onPlayerError,
          },
        });
      } else {
        // ì´ë¯¸ í”Œë ˆì´ì–´ê°€ ìˆìœ¼ë©´ ìƒˆë¡œìš´ ID ë¡œë“œ
        player.loadVideoById(videoId);
      }
    }

    // ------------------------------------------------------------
    // 8. í”Œë ˆì´ì–´ ì¤€ë¹„ ì™„ë£Œ ì½œë°±
    // ------------------------------------------------------------
    function onPlayerReady(event) {
      console.log("í”Œë ˆì´ì–´ ì¤€ë¹„ ì™„ë£Œ -> ì˜ìƒ ì¬ìƒ ì‹œë„");
      event.target.playVideo();
    }

    // ------------------------------------------------------------
    // 9. ì—ëŸ¬ ë°œìƒ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°±
    // ------------------------------------------------------------
    function onPlayerError(event) {
      var errorCode = event.data;
      if (errorCode === 101 || errorCode === 150) {
        displayMessage("âš ï¸ ì´ ì˜ìƒì€ ì™¸ë¶€ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì¬ìƒì´ ë¶ˆê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
      } else if (errorCode === 100) {
        displayMessage("âš ï¸ ìš”ì²­í•˜ì‹  ì˜ìƒì„ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ ë¹„ê³µê°œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. (Error 100)");
      } else {
        displayMessage("âš ï¸ ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (Error " + errorCode + ")");
      }
      console.error("YouTube Player Error ì½”ë“œ:", errorCode);
    }

    // ------------------------------------------------------------
    // 10. ìƒíƒœ ë©”ì‹œì§€ë¥¼ í‘œì‹œ/ì´ˆê¸°í™”í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
    // ------------------------------------------------------------
    function displayMessage(text) {
      var msgEl = document.getElementById("statusMessage");
      msgEl.textContent = text;
    }
    function clearMessage() {
      var msgEl = document.getElementById("statusMessage");
      msgEl.textContent = "";
    }
  </script>
</body>
</html>
